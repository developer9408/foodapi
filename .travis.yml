language: python
python:
    - "3.6"

services:
- docker

before_deploy:
    - 'curl "https://s3.amazonaws.com/aws-cli/awscli-bundle.zip" -o "awscli-bundle.zip"'
    - 'unzip awscli-bundle.zip'
    - sudo ./awscli-bundle/install -i /usr/local/aws -b /usr/local/bin/aws
    - 'export PATH=~/bin:$PATH'
    - 'aws configure'
 

script:
    - eval $(aws ecr get-login --region $AWS_DEFAULT_REGION --no-include-email)
    - docker-compose build
    - docker tag foodapi:latest public.ecr.aws/g5w5n8y2/foodapi:latest
    - docker push public.ecr.aws/g5w5n8y2/foodapi:latest

